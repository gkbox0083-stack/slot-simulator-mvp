# v1.5.1 Acceptance Checklist — Wild（最小集）

> 用來驗收「Wild 實作是否正確且未污染架構」。
> 每一條都應可用測試、或用 deterministic case 重播確認。

---

## A. 範圍與紅線

- [ ] 僅影響 BASE + LINE pay（未引入 ANY_POSITION）
- [ ] 未引入 Scatter / Free / FSM 行為（FSM 無感）
- [ ] 未引入 multi-win（每 spin 0~1 WinEvent）
- [ ] Visual 層未新增掃盤自判 wins

---

## B. Evaluator / Predicate 位置正確性

- [ ] paylines 遍歷 loops 未因 Wild 改動（沒有新增掃盤/判線流程）
- [ ] 符號比對已抽象為 predicate（例如 isMatch / equivalence）
- [ ] evaluator 不含 `if (type==='WILD')` 等硬編碼特判
- [ ] Wild substitute 規則由 ruleCtx/config 驅動（wildConfig）

---

## C. Config 驅動

- [ ] `symbols` 中以 `type: "WILD"` 定義 Wild
- [ ] `wildConfig.wildSymbolId` 與 symbols 定義一致
- [ ] `wildConfig.substitutableTypes` 僅包含 HIGH/MID/LOW（或你實際採用的可替代集合）
- [ ] 若存在 SCATTER/BONUS/FEATURE，其 type 不在 substitutableTypes

---

## D. WinEvent 語義（paid vs observed）

- [ ] WinEvent 包含 `paidSymbolId`
- [ ] WinEvent 包含 `observedSymbolIds`，且長度 == positions 長度
- [ ] case: H1-H1-W 以 H1 計價時：paidSymbolId=H1，observedSymbolIds 末位為 W
- [ ] positions 座標系仍為 [row,col] 且與 paylines 一致

---

## E. Determinism / Strict Validation

- [ ] RNG determinism preserved（rng.js 未改）
- [ ] evaluator 每 spin 僅被呼叫一次
- [ ] STRICT_MODE：expectedWin == evaluatedWin（0 mismatches）
- [ ] 結果可重播（相同 seed → 相同 outcome / grid / winEvents）

---

## F. Regression Smoke（最小）

- [ ] 不含 Wild 的盤面/回放，結果與 v1.5.0 baseline 一致
- [ ] WildConfig 關閉/移除時（或 wildSymbol 不出現），系統無副作用


---

## G. 錯誤處理（Error Handling）

- [ ] wildConfig 缺失時，Evaluator 正常運作（視為無 Wild；predicate 退化為 ===）
- [ ] wildSymbolId 不存在於 symbols 定義時，Validator 報錯（或啟動時明確 throw）
- [ ] substitutableTypes 若包含 SCATTER/BONUS/FEATURE 等禁止類型，Validator 報錯
- [ ] grid 中出現 Wild 但 wildConfig 未定義：行為明確（視為普通符號，只能與自身相等）
